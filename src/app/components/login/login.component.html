<div class="login-container">
  <p-toast></p-toast>
  
  <p-card class="login-card">
    <ng-template pTemplate="header">
      <div class="login-header">
        <div class="logo-container">
          <i class="pi pi-chart-bar"></i>
        </div>
        <h1>CASHedi</h1>
        <p>Connectez-vous à votre compte pour continuer</p>
      </div>
    </ng-template>

    <ng-template pTemplate="content">
      <!-- Error Message -->
      <div *ngIf="errorMessage" class="error-banner">
        <i class="pi pi-exclamation-triangle"></i>
        <span>{{ errorMessage }}</span>
      </div>

      <form [formGroup]="loginForm" (ngSubmit)="onSubmit()" class="login-form">
        <!-- Email Field -->
        <div class="field">
          <label for="email">Email *</label>
          <input 
            pInputText 
            id="email" 
            type="email" 
            placeholder="votre@email.com"
            formControlName="email"
            [class.ng-invalid]="isFieldInvalid('email')"
            autocomplete="email" />
          <small *ngIf="isFieldInvalid('email')" class="p-error">
            {{ getFieldError('email') }}
          </small>
        </div>

        <!-- Password Field -->
        <div class="field">
          <div class="password-header">
            <label for="password">Mot de passe *</label>
            <a href="#" class="forgot-password">Mot de passe oublié?</a>
          </div>
          <p-password 
            id="password" 
            formControlName="password"
            [class.ng-invalid]="isFieldInvalid('password')"
            [feedback]="false"
            [toggleMask]="true"
            placeholder="Votre mot de passe"
            autocomplete="current-password">
          </p-password>
          <small *ngIf="isFieldInvalid('password')" class="p-error">
            {{ getFieldError('password') }}
          </small>
        </div>

        <!-- Remember Me -->
        <div class="field-checkbox">
          <p-checkbox 
            id="rememberMe" 
            formControlName="rememberMe" 
            binary="true">
          </p-checkbox>
          <label for="rememberMe">Se souvenir de moi</label>
        </div>

        <!-- Login Button -->
        <p-button 
          type="submit"
          [label]="isLoading ? 'Connexion...' : 'Se connecter'"
          [loading]="isLoading"
          [disabled]="loginForm.invalid"
          styleClass="w-full">
        </p-button>
      </form>

      <!-- Divider -->
      <p-divider align="center">
        <span class="divider-text">Ou continuer avec</span>
      </p-divider>

      <!-- HubSpot Login Button -->
      <p-button 
        type="button"
        label="Se connecter avec HubSpot"
        severity="secondary"
        styleClass="w-full hubspot-button"
        [loading]="isLoading"
        (click)="onHubSpotLogin()">
        <ng-template pTemplate="icon">
          <i class="pi pi-external-link"></i>
        </ng-template>
      </p-button>
    </ng-template>

    <ng-template pTemplate="footer">
      <div class="login-footer">
        <p>Pas encore de compte? Contactez votre administrateur</p>
      </div>
    </ng-template>
  </p-card>
</div>
